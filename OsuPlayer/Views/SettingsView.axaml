<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:views="clr-namespace:OsuPlayer.Views"
             xmlns:valueConverters="clr-namespace:OsuPlayer.Extensions.ValueConverters;assembly=OsuPlayer.Extensions"
             xmlns:controls="clr-namespace:OsuPlayer.Controls"
             xmlns:avalonia="clr-namespace:Markdown.Avalonia;assembly=Markdown.Avalonia"
             xmlns:ctxt="clr-namespace:ColorTextBlock.Avalonia;assembly=ColorTextBlock.Avalonia"
             xmlns:osuPlayer="clr-namespace:OsuPlayer"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="OsuPlayer.Views.SettingsView"
             Initialized="SettingsView_OnInitialized">
    <UserControl.Resources>
        <valueConverters:SettingsUserConverter x:Key="SettingsUserConverter" />
        <valueConverters:GridFormatter x:Key="GridFormatter" />
    </UserControl.Resources>
    <Design.DataContext>
        <views:SettingsViewModel />
    </Design.DataContext>

    <Grid RowDefinitions="Auto, *">
        <TextBox Grid.Row="0" Name="SettingsSearch" Text="{Binding SettingsSearchQ}"
                 Watermark="type to search for settings" Margin="10 10 10 0" />

        <ScrollViewer Grid.Row="1">
            <controls:CascadingWrapPanel
                ItemWidth="{Binding RelativeSource={RelativeSource Self}, Path=Bounds.Width, Converter={StaticResource GridFormatter}, ConverterParameter=700}"
                Name="SettingsGrid">

                <Grid RowDefinitions="Auto" Margin="10" Name="GeneralSettings">
                    <Panel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <ExperimentalAcrylicBorder IsHitTestVisible="False">
                            <ExperimentalAcrylicBorder.Material>
                                <ExperimentalAcrylicMaterial
                                    BackgroundSource="Digger"
                                    TintColor="Black"
                                    TintOpacity="1"
                                    MaterialOpacity="0.75" />
                            </ExperimentalAcrylicBorder.Material>
                        </ExperimentalAcrylicBorder>
                    </Panel>

                    <StackPanel Spacing="10" Margin="10" Name="GeneralSettingsPanel">
                        <TextBlock Text="{x:Static osuPlayer:Resources.GeneralSettingsTitle}" FontSize="32"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Stretch" />

                        <StackPanel Spacing="5" Name="ImportOsuSongs">
                            <TextBlock Text="{Binding OsuLocation}" />
                            <Button Content="{x:Static osuPlayer:Resources.ImportSongsText}" Click="ImportSongsClick"
                                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" />
                        </StackPanel>

                        <StackPanel Spacing="5" Name="ImportCollections">
                            <TextBlock Text="{x:Static osuPlayer:Resources.ImportSongsText}" />
                            <Button Content="{x:Static osuPlayer:Resources.StartImportText}" Click="ImportCollectionsClick"
                                    HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" />
                        </StackPanel>

                        <StackPanel Spacing="5" Name="Language">
                            <TextBlock Text="{x:Static osuPlayer:Resources.Language}" />
                            <ComboBox SelectedItem="{Binding CurrentLanguage}"
                                      Items="{Binding AvailableLanguages}" HorizontalAlignment="Stretch" />
                        </StackPanel>
                        
                        <StackPanel Spacing="5" Name="WindowBlurMethod">
                            <TextBlock Text="{x:Static osuPlayer:Resources.WindowBlurMethodTitle}" />
                            <ComboBox SelectedItem="{Binding SelectedTransparencyLevel}"
                                      Items="{Binding WindowTransparencyLevels}" HorizontalAlignment="Stretch" />
                        </StackPanel>

                        <StackPanel Spacing="5" Name="StartupSong">
                            <TextBlock Text="{x:Static osuPlayer:Resources.StartupSongTitle}" />
                            <ComboBox SelectedItem="{Binding SelectedStartupSong}" Items="{Binding StartupSongs}"
                                      HorizontalAlignment="Stretch" />
                        </StackPanel>

                        <StackPanel Spacing="5" Name="SongsSortingMode">
                            <TextBlock Text="{x:Static osuPlayer:Resources.SortingModeTitle}" />
                            <ComboBox SelectedItem="{Binding SelectedSortingMode}" Items="{Binding SortingModes}"
                                      HorizontalAlignment="Stretch" />
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <Grid RowDefinitions="Auto" Margin="10" Name="UserSettings">
                    <Panel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <ExperimentalAcrylicBorder IsHitTestVisible="False">
                            <ExperimentalAcrylicBorder.Material>
                                <ExperimentalAcrylicMaterial
                                    BackgroundSource="Digger"
                                    TintColor="Black"
                                    TintOpacity="1"
                                    MaterialOpacity="0.75" />
                            </ExperimentalAcrylicBorder.Material>
                        </ExperimentalAcrylicBorder>
                    </Panel>

                    <StackPanel Margin="10" Spacing="10" Name="UserSettingsPanel">
                        <TextBlock Text="{x:Static osuPlayer:Resources.UserSettingsTitle}" FontSize="32" VerticalAlignment="Center"
                                   HorizontalAlignment="Stretch" />

                        <StackPanel Spacing="5" Name="Login">
                            <TextBlock Text="{Binding CurrentUser, Converter={StaticResource SettingsUserConverter}}" />
                            <Button Content="{x:Static osuPlayer:Resources.Login}" Click="LoginClick" HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center" />
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <Grid RowDefinitions="Auto" Margin="10" Name="AudioSettings">
                    <Panel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <ExperimentalAcrylicBorder IsHitTestVisible="False">
                            <ExperimentalAcrylicBorder.Material>
                                <ExperimentalAcrylicMaterial
                                    BackgroundSource="Digger"
                                    TintColor="Black"
                                    TintOpacity="1"
                                    MaterialOpacity="0.75" />
                            </ExperimentalAcrylicBorder.Material>
                        </ExperimentalAcrylicBorder>
                    </Panel>

                    <StackPanel Margin="10" Spacing="10" Name="AudioSettingsPanel">
                        <TextBlock Text="{x:Static osuPlayer:Resources.AudioSettingsTitle}" FontSize="32" VerticalAlignment="Center"
                                   HorizontalAlignment="Stretch" />

                        <StackPanel Spacing="5" Name="EqualizerSettings">
                            <TextBlock Text="{x:Static osuPlayer:Resources.EqualizerSettingsText}" />
                            <Button Content="{x:Static osuPlayer:Resources.OpenEqualizerText}" Click="OpenEqClick" HorizontalAlignment="Stretch"
                                    HorizontalContentAlignment="Center" />
                        </StackPanel>
                    </StackPanel>
                </Grid>
                
                <Grid RowDefinitions="Auto" Margin="10" Name="PatchnotesSettings">
                    <Panel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                        <ExperimentalAcrylicBorder IsHitTestVisible="False">
                            <ExperimentalAcrylicBorder.Material>
                                <ExperimentalAcrylicMaterial
                                    BackgroundSource="Digger"
                                    TintColor="Black"
                                    TintOpacity="1"
                                    MaterialOpacity="0.75" />
                            </ExperimentalAcrylicBorder.Material>
                        </ExperimentalAcrylicBorder>
                    </Panel>
                    
                    <StackPanel Margin="10" Spacing="10" Name="PatchnotesPanel">
                        <TextBlock Text="{x:Static osuPlayer:Resources.PatchNotesTitle}" FontSize="32" VerticalAlignment="Center"
                                   HorizontalAlignment="Stretch" />

                        <avalonia:MarkdownScrollViewer Markdown="{Binding Patchnotes}">
                            <avalonia:MarkdownScrollViewer.Styles>
                                <Style Selector="ctxt|CTextBlock.Heading2">
                                    <Setter Property="Foreground" Value="White"/>
                                </Style>
                            </avalonia:MarkdownScrollViewer.Styles>
                        </avalonia:MarkdownScrollViewer>
                    </StackPanel>
                </Grid>
            </controls:CascadingWrapPanel>
        </ScrollViewer>
    </Grid>
</UserControl>